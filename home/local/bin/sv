#!/system/bin/sh
# vim: ft=sh
# Small service manager for optware-ng
NAME=$2
DIR=/opt/etc/init.d
DAEMON="$DIR/$NAME"
 
case "$1" in
    'start')
        $DAEMON start
        ;;
    'stop')
        $DAEMON stop
        ;;
    'restart')
        $DAEMON restart
        ;;
    'list')
        for f in $DIR/*; do
            if [ -f $f ]; then
                echo `basename $f`
            fi
        done
        ;;
    'enabled')
        for f in $DIR/enabled/*; do
            if [ -f $f ]; then
                echo `basename $f`
            fi
        done
        ;;
    'enable')
        if [ -f $DAEMON ]; then
            ln -s $DAEMON $DIR/enabled/
            echo "Enabled $NAME"
        else
            echo "No such file $DAEMON"
        fi
        ;;
    'disable')
        if [ -f $DIR/enabled/$NAME ]; then
            rm $DIR/enabled/$NAME
            echo "Disabled $NAME"
        else
            echo "$DAEMON is already disabled"
        fi
        ;;
    *)
        echo "usage: `basename $0` {start|stop|restart|list|enable|disable|enabled} [service]"
esac

